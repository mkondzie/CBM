dynamic threshold based on average of plus minus 5 channels around this channel 
odd and even channels separately


ios::in	Open for input operations.
ios::out	Open for output operations.

ios::app	All output operations are performed at the end of the file, appending the content to the current content of the file.



threshold: window +/- 5 % positive (if it includes positve then also the negative)
average / max amplitude 

suspicious almost above threshold

ADC in th2d 
projection of Y axis sum over bins take weighted average or median

add a condition for problematic channels

Do a scan to determine the optimal conditions for putting the threshold
number of broken channels vs neighboring channels (to put a threshold)
neighboring channels vs threshold in % in th2d


criteria separate for each channel based on weighted average


webp extension:
url includes .png remove the rest of the link (resize argument converts to .webp)photo 


h2hits_amp->GetNbinsX()

ch: 72 sus_even: 2.03374
ch: 98 sus_even: 2.16638

Filename_selected: conn_check_240109_0954_XA-000-08-001-064-051-048-13_HW_2_SET_56_17_102_35_NL_5_holes

ch: 24 sus_even: 1.49147
ch: 114 sus_even: 1.67738

__________
ch: 72 sus_even: 2.03374
median of weighted av: 2.06946
thr_even_sus: 1.1382
__________
ch: 98 sus_even: 2.16638
median of weighted av: 2.10388
thr_even_sus: 1.15713


__________
ch: 24 sus_even: 1.49147
median of weighted av: 1.49902
thr_even_sus: 0.82446
__________
ch: 114 sus_even: 1.67738
median of weighted av: 1.65875
thr_even_sus: 0.912311


large open arrow / open circle mark as suspicious

hist of weighted average of each channel


the algorithm appears to be ~98% accurate

it needs to be at least 95% accurate

if we multiply the accuracy for each module 

then the final accuracy is still lower

approximately 90%

that's why we need to improve broken channels recognition

weighted average projection (rotate over x axis to get the stddev)
(x,y)->y

hist without weights
X: weigthed average
Y:channel
to get stddev
3 sigma, 5 sigma

mark noisy channels at the end (i.e. channel 128) but they're not broken


3 different reasons for broken channels:
completely no response 0
broken microcable 


[mk@collider L3DL300112]$ echo M3DL3*/conn_check_files/ | xargs -n 1 cp my_analysis_conn_check.C 
https://net2.com/how-to-copy-a-file-to-multiple-directories-in-linux/


showcasing the z strips and noisy channels
M3DL3T0001120A2

worst case scenarios vs scan of broken channels:
 
a cluster of broken channels near the threshold 
the cluster is comparable with the neighborhood
M3DL3T2001122A2

the threshold is still sensitive to the cluster
normal channels are marked as broken
M3DL3T1001121A2

 z_alpha              n_neigh_ch                sus_perc                n_sigmas
 0.550000                      25                0.300000                5.000000             

